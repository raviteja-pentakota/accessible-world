<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sighted Assistance Request | Accessible World</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f8f9fa; padding: 20px; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
    .container { max-width: 600px; width: 100%; margin: auto; background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
    h2 { color: #0056b3; text-align: center; margin-bottom: 20px; }
    form label { display: block; margin-bottom: 8px; font-weight: bold; }
    form input, form select, form textarea { width: calc(100% - 24px); padding: 12px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; }
    form button { width: 100%; padding: 15px; background-color: #007bff; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; font-weight: bold; transition: background-color 0.3s ease; }
    form button:hover { background-color: #0056b3; }
    #statusMessage { text-align: center; margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Request Sighted Assistance</h2>
    <form id="assistanceForm">
      <label for="name">Full Name</label>
      <input type="text" id="name" required>

      <label for="phone">Contact Phone Number</label>
      <input type="tel" id="phone" required>

      <label for="altPhone">Alternative Number (if any)</label>
      <input type="tel" id="altPhone">

      <label for="gender">Gender</label>
      <select id="gender" required>
        <option value="">Select</option>
        <option>Male</option>
        <option>Female</option>
        <option>Other</option>
      </select>

      <label for="need">Need Assistance For</label>
      <select id="need" required>
        <option value="">Select</option>
        <option value="travel">Travel</option>
        <option value="personal">Personal Work</option>
        <option value="shopping">Shopping</option>
        <option value="vehicle">Vehicle Assistance</option>
        <option value="exam">Exam Scribe</option>
        <option value="others">Others</option>
      </select>

      <div id="travelDetails" style="display:none;">
        <label for="from">Travel From</label>
        <input type="text" id="from">

        <label for="to">Travel To</label>
        <input type="text" id="to">

        <label for="days">How many days?</label>
        <input type="number" id="days" min="1">
      </div>

      <button type="submit">Submit Request</button>
      <p id="statusMessage"></p>
    </form>
  </div>

  <script type="module">
    // Import Firebase services
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
    import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";

    // Update Firebase configuration to use your current project
    const firebaseConfig = {
      apiKey: "AIzaSyBZUQXgfdDHrntbBVSVFf8Vvtp9V5qnERg",
      authDomain: "accessible-learn-and-win-ad21f.firebaseapp.com",
      projectId: "accessible-learn-and-win-ad21f",
      storageBucket: "accessible-learn-and-win-ad21f.appspot.com",
      messagingSenderId: "299849578412",
      appId: "1:299849578412:web:1e66a3292e35578f102c09",
      measurementId: "G-G832YW57EK"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const needSelect = document.getElementById("need");
    const travelDetails = document.getElementById("travelDetails");
    const statusMessage = document.getElementById("statusMessage");

    needSelect.addEventListener("change", () => {
      travelDetails.style.display = needSelect.value === "travel" ? "block" : "none";
    });

    document.getElementById("assistanceForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      statusMessage.textContent = "Submitting your request...";
      statusMessage.style.color = "#0056b3";

      try {
        await addDoc(collection(db, "assistanceRequests"), {
          name: document.getElementById("name").value,
          phone: document.getElementById("phone").value,
          altPhone: document.getElementById("altPhone").value,
          gender: document.getElementById("gender").value,
          need: document.getElementById("need").value,
          from: document.getElementById("from").value || null,
          to: document.getElementById("to").value || null,
          days: document.getElementById("days").value || null,
          submittedAt: serverTimestamp()
        });
        statusMessage.textContent = "Your request has been submitted successfully!";
        statusMessage.style.color = "green";
        e.target.reset();
        travelDetails.style.display = "none";
      } catch (err) {
        console.error("Error submitting request:", err);
        statusMessage.textContent = "Failed to submit request. Please try again.";
        statusMessage.style.color = "red";
      }
    });
  </script>
</body>
</html>
